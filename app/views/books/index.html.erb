<div class="container">

<h1>Books</h1>

<table class="table">
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Author</th>
      <th>Publish an article</th>
      <th>Published date</th>
      <th>Publisher</th>
      <th>Borrow fee</th>
      <th>Quantity</th>
      <th>Quantity in stock</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @books.each do |book| %>
      <tr>
        <td><%= book.name %></td>
        <td><%= book.description %></td>
        <td>
          <% book.author_books.each do |author_book|%>
          <li>
          <%= author_book.author.author_name%>
          </li>
          <%end%>
        </td>
        <td><%= book.created_at%></td>
        <td><%= book.published_date %></td>
        <td><%= Publisher.find(book.publisher_id).publisher_name if book.publisher_id %></td>
        <td><%= book.borrow_fee %></td>
        <td><%= book.quantity %></td>
        <td><%= book.quantity_in_stock %></td>
        <td><%= link_to 'Show', book %></td>
         <td>
        <%= form_for ([book, book.borrows.build]) do |f|%>
        <%= f.hidden_field :status, value: "waiting accept"%>
         <%= f.submit "Borrow",class:"btn btn-success", data: { confirm: "Are you sure to borrow #{book.name} book "}%>
         <%end%>
        </td>
        <% if user_signed_in? %>
        <td><%= link_to 'Edit', edit_book_path(book) %></td>
        <td><%= link_to 'Destroy', book, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<br>
<%if user_signed_in?%>
<%= link_to 'New Book', new_book_path %>
<%end%>
<%= will_paginate @books, renderer: WillPaginate::ActionView::BootstrapLinkRenderer %>
</div>